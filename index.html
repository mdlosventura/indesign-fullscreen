<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Fullscreen InDesign Export (Bulletproof)</title>
    <link href="main.css" rel="stylesheet" type="text/css">
<script src="main.js" type="text/javascript"></script>
<iframe id="contentIFrame" class="contentIframeClass"
        src="publication.html"></iframe>
    <style>
      html, body { height:100%; margin:0; background:#fff; overflow:hidden; }
      /* No rely on body flex; we position the iframe absolutely and center via transform */
      #contentIFrame {
        position:absolute;
        top:0; left:0;
        transform-origin: top left;
        border:none;
        display:block;
      }
      #dummyIFrame { display:none; }
      .prev, .next {
        position: fixed;
        top: 50%;
        transform: translateY(-50%);
        font-size: 40px;
        cursor: pointer;
        user-select: none;
        color: #000;
        z-index: 1000;
        padding: 6px 10px;
      }
      .prev { left: 16px; }
      .next { right: 16px; }
    </style>
  </head>
  <body>
    <iframe id="contentIFrame" class="contentIframeClass" src="publication-web-resources/html/publication.html"></iframe>
    <iframe id="dummyIFrame" class="dummyFrameClass"></iframe>
    <div class="prev" onclick="showPreviousPage()">&#10094;</div>
    <div class="next" onclick="showNextPage()">&#10095;</div>

    <script>
      (function(){
        const W = 842, H = 595; // Natural size of your InDesign page (A4 landscape)
        const iframe = document.getElementById('contentIFrame');

        function fit() {
          if (!iframe) return;
          iframe.style.width = W + 'px';
          iframe.style.height = H + 'px';
          iframe.style.position = 'absolute';
          iframe.style.transformOrigin = 'top left';
          iframe.style.border = 'none';

          const vw = window.innerWidth, vh = window.innerHeight;
          const s = Math.min(vw / W, vh / H);
          const x = (vw - W * s) / 2;
          const y = (vh - H * s) / 2;
          iframe.style.transform = 'translate(' + x + 'px,' + y + 'px) scale(' + s + ')';
        }

        function whenIframeReady(cb) {
          try {
            const doc = iframe && (iframe.contentDocument || iframe.contentWindow && iframe.contentWindow.document);
            if (doc && doc.readyState === 'complete') return cb();
          } catch(e) { /* cross-domain not expected here */ }
          setTimeout(function(){ whenIframeReady(cb); }, 100);
        }

        function initFit(){
          if (typeof showHideArrows === 'function') showHideArrows();
          fit();
        }

        // Run once iframe is fully loaded (and also re-check if needed)
        iframe.addEventListener('load', function(){ setTimeout(initFit, 100); });
        whenIframeReady(function(){ requestAnimationFrame(initFit); });
        window.addEventListener('resize', fit);
      })();
    </script>
  </body>
</html>
